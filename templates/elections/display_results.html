{% extends "admin/base_site.html" %}
{% load i18n admin_static admin_urls %}

{% block breadcrumbs %}
    <div class="breadcrumbs">
        <a href="{% url 'admin:index' %}">{% trans 'Home' %}</a>
        &rsaquo; <a href="{% url 'admin:app_list' app_label=opts.app_label %}">{{ opts.app_config.verbose_name }}</a>
        &rsaquo; <a href="{% url opts|admin_urlname:'changelist' %}">{{ opts.verbose_name_plural|capfirst }}</a>
        &rsaquo; <a
            href="{% url opts|admin_urlname:'change' object.pk|admin_urlquote %}">{{ object|truncatewords:"18" }}</a>
        &rsaquo; {% trans 'Result' %}
    </div>
{% endblock %}

{% block extrastyle %}
    <link rel="stylesheet" type="text/css" href="{% static "admin/css/forms.css" %}"/>
{% endblock %}

{% block content %}

    <div class="content-main">
        <h2>Total Registered Voters: {{ object.total_voters }}</h2>
        <h2 id="voted">hello</h2>
        <div class="inline-group">
            <div class="tabular inline-related">
                {% for post in posts %}
                    <fieldset class="module" style="display: none">
                        <h2>{{ post.name }}</h2>
                        <table>
                            <thead>
                            <tr>
                                <th colspan="2" class="required">Candidate Name</th>
                                <th class="required">Yes</th>
                                <th class="required">No</th>
                            </tr>
                            </thead>
                            <tbody>
                                {% for candidate in post.candidates.all %}
                                    <tr class="{% cycle "row1" "row2" %}">
                                        <th colspan="2">{{ candidate.name }}</th>
                                        <th class="vote">{{ candidate.yes_votes }}</th >
                                        <th class="vote">{{ candidate.no_votes }}</th>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </fieldset>
                {% endfor %}

                {%if object.is_finished == True%}
                <script>
                    let s = document.getElementsByClassName("module");
                    s[0].style.display = "block";
                </script>
                {%endif%}
                <!-- else -->
                <script>
                    let count = 0;
                    let elements = document.getElementsByClassName("vote");
                    for (var i = 0, len = elements.length; i < len; i++) {
                        count = count + parseInt(elements[i].innerText, 10);
                    }
                    let voted = document.getElementById("voted");
                    voted.innerText = count + " already voted";
                </script>
            </div>
        </div>
    </div>

{% endblock %}